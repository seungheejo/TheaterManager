<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="theater.service.TheaterMapper">
	<!-- メンバー登録 insert -->
	<insert id="insertMember" parameterType="theatermember">
		INSERT
		INTO theaterMember(memberNum, name, grade, email, phoneNum, id, PW,
		points)
		VALUES (theatermember_seq.nextval, #{name}, #{grade}, #{email}, #{phoneNum},
		#{id}, #{PW}, #{points})
	</insert>

	<!-- メンバーの予約 insert -->
	<insert id="memberReserveTicket">
		INSERT
		INTO reservation(reserveNum, movieTitle, theaterName, chosenSeat,
		ticketPrice, id, email,genre)
		VALUES (reserveNum_seq.nextval,#{movieTitle}, #{theaterName}, #{chosenSeat},
		#{ticketPrice}, #{id}, #{email}, #{genre})
	</insert>

	<!-- 予約のキャンセル delete -->
	<delete id="deleteReservedTicket">
		DELETE reservation
		WHERE reservenum = #{reservenum}
	</delete>

	<!-- ノンメンバーの予約 insert -->
	<insert id="nonmemberReserveTicket">
		INSERT
		INTO reservation(reserveNum, movieTitle, theaterName, chosenSeat,
		ticketPrice, email, genre)
		VALUES (reserveNum_seq.nextval,#{movieTitle}, #{theaterName}, #{chosenSeat},
		#{ticketPrice}, #{email}, #{genre})
	</insert>

	<!-- 予約の確認 select -->
	<select id="reservationInfo" resultType="reservation">
		SELECT *
		FROM reservation
	</select>

	<!-- ID別に予約した映画の情報 select -->
	<select id="idReservationInfo" resultType="reservation">
		SELECT *
		FROM reservation
		WHERE id = #{id}
	</select>

	<!-- 全ての映画の上映情報 select -->
	<select id="getShowingInfo" resultType="movie">
		SELECT *
		FROM movie
	</select>

	<!-- プチョン映画館で上映中の映画情報 select -->
	<select id="getShowingBucheonInfo" resultType="movie">
		SELECT *
		FROM movie
		WHERE theaterName like '%부천%'
	</select>

	<!-- インチョン映画館で上映中の映画情報 select -->
	<select id="getShowingIncheonInfo" resultType="movie">
		SELECT *
		FROM movie
		WHERE theaterName like '%인천%'
	</select>

	<!-- ヨンサン映画館で上映中の映画情報 select -->
	<select id="getShowingYongsanInfo" resultType="movie">
		SELECT *
		FROM movie
		WHERE theaterName like '%용산%'
	</select>

	<!-- ワンシムニ映画館で上映中の映画情報 select -->
	<select id="getShowingWangsibriInfo" resultType="movie">
		SELECT *
		FROM movie
		WHERE theaterName like '%왕십리%'
	</select>

	<!-- プチョン映画館の座席情報 select -->
	<select id="getBucheonSeatsInfo" resultType="seatinfo">
		SELECT *
		FROM seatinfo
		WHERE theaterName like '%부천%'
	</select>

	<!-- インチョン映画館の座席情報 select -->
	<select id="getIncheonSeatsInfo" resultType="seatinfo">
		SELECT *
		FROM seatinfo
		WHERE theaterName like '%인천%'
	</select>

	<!-- ヨンサン映画館の座席情報 select -->
	<select id="getYongsanSeatsInfo" resultType="seatinfo">
		SELECT *
		FROM seatinfo
		WHERE theaterName like '%용산%'
	</select>

	<!-- ワンシムニ映画館の座席情報 select -->
	<select id="getWangsibriSeatsInfo" resultType="seatinfo">
		SELECT *
		FROM seatinfo
		WHERE theaterName like '%왕십리%'
	</select>

	<!-- プチョン映画館の座席情報のアップデート update -->
	<update id="updateBucheonBookingInfo">
		UPDATE seatinfo
		SET bookingInfo = #{bookingInfo}
		WHERE seats = #{seats} AND theaterName like '%부천%'
	</update>

	<!-- インチョン映画館の座席情報のアップデート update -->
	<update id="updateIncheonBookingInfo">
		UPDATE seatinfo
		SET bookingInfo = #{bookingInfo}
		WHERE seats = #{seats} AND theaterName like '%인천%'
	</update>

	<!-- ヨンサン映画館の座席情報のアップデート update -->
	<update id="updateYongsanBookingInfo">
		UPDATE seatinfo
		SET bookingInfo = #{bookingInfo}
		WHERE seats = #{seats} AND theaterName like '%용산%'
	</update>

	<!-- ワンシムニ映画館の座席情報のアップデート update -->
	<update id="updateWangsibriBookingInfo">
		UPDATE seatinfo
		SET bookingInfo = #{bookingInfo}
		WHERE seats = #{seats} AND theaterName like '%왕십리%'
	</update>

	<!-- ジャンル別の映画情報 select -->
	<select id="getMovieRecommend" resultType="movie">
		SELECT *
		FROM movie
		WHERE genre = #{genre}
	</select>

	<!-- 全てのメンバーの情報 select -->
	<select id="getTheaterMemberInfo" resultType="theatermember">
		SELECT *
		FROM theaterMember
	</select>

	<!-- 脱退 delete -->
	<delete id="deleteMember">
		DELETE theaterMember
		WHERE id = #{id} <!-- idが固有値なので-->
	</delete>
</mapper>
